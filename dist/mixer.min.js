/*! mixer - v0.3.0 - 30-08-2013 */
!function(){define("datastore",["eventmap","mixer"],function(a,b){var c,d;return d=function(a){return a.replace(/-/g,"").replace(/_/g,"").toLowerCase()},c=function(){function c(){}return c.prototype.contructor=function(d){return b(c.prototype,new a),this.data={collection:{},state:{}},d?"string"==typeof d?this.fromString(d):this.set(d):void 0},c.prototype.fromString=function(a){var b;try{return this.data.collection=JSON.parse(a)}catch(c){return b=c,console.error("Error while parsing content: "+b)}},c.prototype.toString=function(){var a;try{return JSON.stringify(this.data.collection)}catch(b){return a=b,console.error("Error while serializing data: "+a)}},c.prototype.add=function(a,b,c){return null==c&&(c="rw"),this.exists(a)?void 0:(this.trigger("add",a,b),this.data.collection[a]=b,"readonly"===d(c)&&(c="ro"),"writeonly"===d(c)&&(c="wo"),this.data.state[a]=c)},c.prototype.exists=function(a){return this.trigger("exists",a),Object.hasOwnProperty.call(this.data.collection,a)},c.prototype.has=c.exists,c.prototype.remove=function(a){return this.trigger("remove",a),delete this.data.collection[a]},c.prototype.keys=function(){return Object.keys(this.data.collection)},c.prototype.get=function(a){return"wo"!==data.state[a]?(this.trigger("get",a),this.data.collection[a]):void 0},c.prototype.set=function(a,b){var c,d;if(b)this.exists(a)?"ro"!==this.data.state[a]&&(this.data.collection[a]=b,this.trigger("set",a,b)):this.add(a,b);else for(c in a)d=a[c],this.set.call(this,c,d);return null},c.prototype.each=function(a){var b,c,d;d=this.data.collection;for(b in d)c=d[b],a(b,c);return null},c.prototype.map=function(a){var b,c,d,e;c={},e=data.collection;for(b in e)d=e[b],c[b]=a(b,d);return c},c.prototype.filter=function(a){var b,c,d,e,f,g;for(c={},g=data.collection,d=e=0,f=g.length;f>e;d=++e)b=g[d],a(data.collection[b])||(c[b]=data.collection[b]);return c},c.prototype.isEmpty=function(){return 0===this.keys().length},c}()})}.call(this);